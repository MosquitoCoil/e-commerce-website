{% extends "adminBase.html" %} {% block title %}Admin Orders{% endblock %} {%
block content %}
<div class="container-fluid mt-4">
  <div class="container-sm">
    <h2><i class="bi bi-receipt"></i> Orders</h2>

    <table
      id="orderTable"
      class="table table-bordered table-striped align-middle"
    >
      <thead class="table-dark text-center">
        <tr>
          <th>ID</th>
          <th>Firstname</th>
          <th>Status</th>
          <th>Date</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        {% for order in orders %}
        <tr>
          <td>{{ order.id }}</td>
          <td>{{ order.firstname }}</td>
          <td>
            {% if order.status == "Pending" %}
            <span class="badge bg-warning">{{ order.status }}</span>
            {% elif order.status == "Processing" %}
            <span class="badge bg-primary">{{ order.status }}</span>
            {% elif order.status == "Delivered" %}
            <span class="badge bg-dark">{{ order.status }}</span>
            {% elif order.status == "Completed" %}
            <span class="badge bg-success">{{ order.status }}</span>
            {% elif order.status == "Cancelled" %}
            <span class="badge bg-danger">{{ order.status }}</span>
            {% elif order.status == "Received" %}
            <span class="badge bg-success"
              ><i class="bi bi-check"></i> {{ order.status }}</span
            >
            {% else %}
            <span class="badge bg-secondary">{{ order.status }}</span>
            {% endif %}
          </td>
          <td>{{ order.created_at.strftime("%Y-%m-%d %H:%M") }}</td>
          <td>
            {% if order.status == "Received" %}
            <button class="btn btn-sm btn-success" disabled>
              <i class="bi bi-check"></i> Received
            </button>
            {% else %}
            <a
              href="{{ url_for('adminOrders.update_order_status', order_id=order.id, status='Pending') }}"
              class="btn btn-sm btn-warning"
              >Pending</a
            >
            <a
              href="{{ url_for('adminOrders.update_order_status', order_id=order.id, status='Processing') }}"
              class="btn btn-sm btn-primary"
              >Accept</a
            >
            <a
              href="{{ url_for('adminOrders.update_order_status', order_id=order.id, status='Delivered') }}"
              class="btn btn-sm btn-dark"
              >Delivered</a
            >
            <a
              href="{{ url_for('adminOrders.update_order_status', order_id=order.id, status='Completed') }}"
              class="btn btn-sm btn-success"
              >Complete</a
            >
            <a
              href="{{ url_for('adminOrders.update_order_status', order_id=order.id, status='Cancelled') }}"
              class="btn btn-sm btn-danger"
              onclick="return confirm('Are you sure you want to cancel this order?');"
            >
              Cancel
            </a>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %} {% block extra_script %}
<script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery-3.7.1.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery.dataTables.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/dataTables.bootstrap5.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/dataTables.responsive.min.js') }}"></script>

<script>
  $(document).ready(function () {
    $("#orderTable").DataTable({
      pageLength: 10,
      lengthMenu: [5, 10, 25, 50],
      ordering: true,
      columnDefs: [{ orderable: false, targets: [4] }], // disable sorting on Action
      searching: true,
      responsive: true,
      language: {
        search: '<i class="bi bi-search"></i>',
        searchPlaceholder: "Search orders...",
      },
    });
  });
</script>
{% endblock %}
