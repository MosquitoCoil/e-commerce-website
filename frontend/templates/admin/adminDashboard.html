{% extends "adminBase.html" %} {% block title %}Admin Dashboard{% endblock %} {%
block content %}
<div class="container-fluid mt-4">
  <div class="container-sm">
    <h1 class="mb-4">Welcome to Admin Dashboard</h1>

    <div class="row g-4">
      <!-- Products -->
      <div class="col-md-3">
        <div class="card text-bg-primary shadow-sm">
          <div class="card-body">
            <h5 class="card-title"><i class="bi bi-box"></i> Products</h5>
            <p class="card-text">Manage all products in the store.</p>
            <a href="/admin/products" class="btn btn-light btn-sm">Go</a>
          </div>
        </div>
      </div>

      <!-- Orders -->
      <div class="col-md-3">
        <div class="card text-bg-success shadow-sm">
          <div class="card-body">
            <h5 class="card-title"><i class="bi bi-cart"></i> Orders</h5>
            <p class="card-text">View and manage customer orders.</p>
            <a href="/admin/orders" class="btn btn-light btn-sm">Go</a>
          </div>
        </div>
      </div>

      <!-- Users -->
      <div class="col-md-3">
        <div class="card text-bg-warning shadow-sm">
          <div class="card-body">
            <h5 class="card-title"><i class="bi bi-person"></i> Users</h5>
            <p class="card-text">Manage registered users.</p>
            <a href="/admin/users" class="btn btn-light btn-sm">Go</a>
          </div>
        </div>
      </div>

      <!-- Reports -->
      <div class="col-md-3">
        <div class="card text-bg-danger shadow-sm">
          <div class="card-body">
            <h5 class="card-title"><i class="bi bi-folder"></i> Reports</h5>
            <p class="card-text">View sales & performance reports.</p>
            <a href="/admin/reports" class="btn btn-light btn-sm">Go</a>
          </div>
        </div>
      </div>
    </div>

    <h2 class="mt-4"><i class="bi bi-bar-chart"></i> Sales Reports</h2>

    <!-- Daily Sales Table -->
    <h4 class="mt-4">Daily Sales</h4>
    <table class="table table-bordered table-striped align-middle">
      <thead class="table-dark text-center">
        <tr>
          <th scope="col">Date</th>
          <th scope="col">Total Sales</th>
          <th scope="col">Products Sold</th>
        </tr>
      </thead>
      <tbody>
        {% for row in daily_sales %}
        <tr>
          <td>{{ row.sale_date }}</td>
          <td>₱{{ "%.2f"|format(row.total_sales) }}</td>
          <td>{{ row.total_products_sold }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- Monthly Sales Table -->
    <h4 class="mt-5">Monthly Sales</h4>
    <table class="table table-bordered table-striped align-middle">
      <thead class="table-dark text-center">
        <tr>
          <th scope="col">Month</th>
          <th scope="col">Total Sales</th>
          <th scope="col">Products Sold</th>
        </tr>
      </thead>
      <tbody>
        {% for row in monthly_sales %}
        <tr>
          <td>{{ row.sale_month }}</td>
          <td>₱{{ "%.2f"|format(row.total_sales) }}</td>
          <td>{{ row.total_products_sold }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- Chart Container -->
    <canvas id="dailySalesChart" class="mt-5"></canvas>
  </div>
</div>
{% endblock %} {% block extra_script %}
<script src="{{ url_for('static', filename='js/chart.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>

<script id="daily-labels" type="application/json">
  {{ daily_sales_labels|tojson }}
</script>
<script id="daily-data" type="application/json">
  {{ daily_sales_values|tojson }}
</script>

<script>
  const dailyLabels = JSON.parse(
    document.getElementById("daily-labels").textContent
  );
  const dailyData = JSON.parse(
    document.getElementById("daily-data").textContent
  );

  const ctx = document.getElementById("dailySalesChart").getContext("2d");
  new Chart(ctx, {
    type: "line",
    data: {
      labels: dailyLabels,
      datasets: [
        {
          label: "Daily Sales (₱)",
          data: dailyData,
          borderColor: "rgba(75, 192, 192, 1)",
          backgroundColor: "rgba(75, 192, 192, 0.2)",
          borderWidth: 2,
          fill: true,
          tension: 0.3,
        },
      ],
    },
    options: {
      responsive: true,
      plugins: { legend: { display: true } },
      scales: { y: { beginAtZero: true } },
    },
  });
</script>
{% endblock %}
