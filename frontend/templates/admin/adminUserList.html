{% extends "admin/adminBase.html" %} {% block title %}Manage Users{% endblock %}
{% block content %}
<div class="container-fluid mt-4">
  <div class="container-sm">
    <h2 class="mb-4">List of Registered Users</h2>

    <button
      class="btn btn-dark mb-3"
      data-bs-toggle="modal"
      data-bs-target="#addUser"
    >
      <i class="bi bi-person-plus"></i> Add User
    </button>

    <div class="container mt-4">
      <table
        id="userTable"
        class="table table-bordered table-striped align-middle"
      >
        <thead class="table-dark">
          <tr>
            <th>No.</th>
            <th>Firstname</th>
            <th>Lastname</th>
            <th>Username</th>
            <th>Time Created</th>
            <th>Role</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for u in users %}
          <tr>
            <td>{{ loop.index }}</td>
            <td>{{ u.firstname.capitalize() }}</td>
            <td>{{ u.lastname.capitalize() }}</td>
            <td>{{ u.username.capitalize() }}</td>
            <td>{{ u.created_at }}</td>
            <td>
              {% if u.is_admin == 'admin' %}
              <span class="badge bg-success">Admin</span>
              {% elif u.is_admin == 'user' %}
              <span class="badge bg-secondary">User</span>
              {% else %}
              <span class="badge bg-dark">{{ u.is_admin }}</span>
              {% endif %}
            </td>
            <td>
              <button
                class="btn btn-sm btn-primary"
                data-bs-toggle="modal"
                data-bs-target="#editUser{{ u.id }}"
              >
                <i class="bi bi-pencil"></i> Edit
              </button>
              <button
                class="btn btn-sm btn-danger"
                data-bs-toggle="modal"
                data-bs-target="#deleteUser{{ u.id }}"
              >
                <i class="bi bi-trash"></i> Delete
              </button>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %} {% block extra_script %}
<script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery-3.7.1.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery.dataTables.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/dataTables.bootstrap5.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/dataTables.responsive.min.js') }}"></script>

<script>
  $(document).ready(function () {
    $("#userTable").DataTable({
      pageLength: 10,
      lengthMenu: [5, 10, 25, 50],
      ordering: true,
      searching: true,
      responsive: true,
      language: {
        search: '<i class="bi bi-search"></i>',
        searchPlaceholder: "Search users...",
      },
    });
  });

  setTimeout(() => {
    document.querySelectorAll(".alert").forEach((alert) => {
      new bootstrap.Alert(alert).close();
    });
  }, 4000);

  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".toast").forEach((toastEl) => {
      new bootstrap.Toast(toastEl, { delay: 3000, autohide: true }).show();
    });
  });
</script>
{% endblock %}
